Game Links:
https://www.facebook.com/groups/298041333699422/
http://steamcommunity.com/sharedfiles/filedetails/?id=514233906

TODO:
- Dispel shouldn't strip inborn statuses.
- Resist should protect against dispel and all other status spells.
- Ensure all spells are working properly.
- Ensure all unit abilities are working properly
- Units having 4 steps intact at the end of the turn can counter attack the attacker (with attacker having some defense bonus), while ranged units could get a shot of opportunity at sighted enemies. Ranged defenders can't counter attack, yet, enemies also can't react to attacks from ranged units.
- Include recall to pentagram into AI's pathfinding.
- height advantage gives +1 to attack
- Casting time for some spells, including casting status icon and action animation for casting units. Caster could be interrupted, if attacked while casting.
- refactor some uses of add_effect into add_param
  should not use Params for effect's script
- rename moves to on_move, etc..
- Think about refactoring genes to use ECS system, where each unit has a list of systems acting on him. Like i.e. poison system and regen systems.
- AI should change vampire into bat form, before attack, and then back to vampire, when he is sees enemy and can attack
- store map events in a separate file
- 1-way portals, leading to situations where enemy can quickly attack player, while player has to find other way.
- traps
- Some way to protect area guardians from undead units. Consider some bless fountains/pedestala, giving nearby units ability to fight undeads. 
- optimize resoure engine, so graphics and sounds would be loaded only when they are needed and deallocated when they are not required.

Design:
- Distance from caster affecting spell cost, so attacking nearby targets would cost the least.
- A way to cast spell, like shell or heal, on all units for additional mana. Have a separate tab for that.
- Generators: a place spawning monsters. Implement generators as a platform, that clones the monster standing on top of it. Player can remove it by moving its own unit on top of it. Unit standing on top of generator will have one additional action: clone, but its cooldown time should be assigned to generator. Higher level monsters will induce higher cooldown. Clones of neautral monsters will then roam the map.
- Pickupable treasures, giving lore. I.e. wizard can buy books and access to knowledge.
- Weapons and other items, that boost carrying creature's stats. Make sure only creatures with hands could use, say, swords. Or limit artifacts only to specific creatures, like humanoids. For examle, there can be an artifact, that grans additional mana per turn to the holder.
- Throwing items.
- Units and spells gaining terrain bonuses.
- AI should cast spell of mastery, when his lossage gets too high
- When one players starts casting spell of mastery, all other players will get notified, so they get a chance to stop caster by allied assault.
- reintroduce sokoban boxes pushing, lifting, falling and floating on water; units standing on top of moved objects should move with them
- when unit drops large item, like crate, it pops under that unit, serving as elevation
- phone/touch version should have transparent buttons
- non-leader units could be able to hide inside bushes
- AI autolocks doors when enemies are nearby and open them, to allow its units to pass
- Destructible trees. By attacking and destroying trees, some creatures could clear way to some goodies or other strategic advantage.
- Day-night cycle, affecting creature sight. Non-undead creatures have 1/2 reduced vision during night. One turn would be equivalent to 1 hour. Total Eclipse spell, turning day into night for the next 16 turns. Light spell mitigates effect of darkness. Same way, inside dungeons sight would be reduced. Day-time lowers cost of law spells and increases cost of chaos spells, while night lowers chaos spells' cost, twilight has no bonus. Use dial like WC3 for UI representation of time.
- Allow savegame only when certain amount of turns have passed since the last load. Each save also increases the number of turns, player has to play between successive saves, that will discourage save scumming.
- X-com style cone FOV, opening a lot of strategic possibilities, like allowing surprise attack from back.
- Global map, where player can find next destination. Collected spells are preserved between maps.
- Steeds: horse, lizard and gryphon; For start, the rider can simply be drawn near his mount's sprite.
  Mount can't attack, while being rided and all actions are the actions of the rider. Rider can unmount into any of the four directions. All incoming damage goes to the mount.
- second (rare) resource like souls or gems, required to summon powerful creatures.
  Maybe only wizard can collect it.
- potion brewing, using cauldron and ingredients, collected from map.
- A quest-giving place, where wizard can get some trivial quest, like killing specific monster or finding some artifact.
- Spells, creatures or structures that could boost mana income or decrease opponent's income or increase opponent's mana cost.
- Spells that summon enchanted items, usable by creatures.
- Structures or artifacts that allow casting additional spells per turn.
- rescueable creatures, depicted with barred cage cell over them.
- colored keys and colored doors and chests these keys open.
- switches, opening doors or unleashing monsters.
- different types of terrain affecting movement speed.
- Winter tileset, where creatures without protection from cold, get damage each turn. Add a spell like warmth or endure cold to counter that.
- Hidden doors, that only creatures with detect illusion could see.
- Map places where creature are immune from magical damage.
- Spending lore or building structures to improve wizard: increasing HP, lowering spell cost, boosting mana generation, reducing cooldown, casting more spells per turn.
- A magic that forces all apple trees to produce fruits.
- A way to boost magic income, like building a node. I.e. by building a special mana-accumulating structure.
- A cauldron would allow converting reagents into mana.
- Bluffing: summoning cheaper, illusionary, version of a creature, that can be banished with disbelieve. Have separate tab for that. Summoning illusion shouldn't require researching that creature.
- Dynamic balance: casting chaos spell increases cost of order spells by 1, then casting order spell would restore the cost, and vice versa. A neutral spell to restore balance.
- Power versions of spells (damage boosted or all targets) should require additional rare mana/catalyst.
- Consider idea of unit's facing direction affecting its vision through FOW and turning would require spending steps.


Regarding bigger mana/health/damage numbers:
- Huge health/damage values will make it harder for player to decide outcome.
- Using larger values can indeed help balancing some unit aspects, like health regeneration or poison. On the other hand, slowing down health regeneration can be implemnted differently and most units already have acceptable rates.
- Huge mana income (hundreds per turn) is not requried either, because spells could be balanced by their cooldown (or by introducing casting time) and distance-based spell could simply be rounded (i.e. each 5 cells cost additional 1 mana).
- Even with huge numbers, units should still kill other units in a discrete number of hits (i.e. ratman would kill other ratman in 3 hits, while tier=2 fighter would kill ratman in 2 hits)


Creatures:
- A creature ability to pass through solid objects and enemies, but only if their movement ends in an empty cell.
- Creatures that prevent enemies from running away, forcing them to stay near the creature with such ability.
- A creature that is permanently invisible, unless under the sight of oculus.
- Creature alignments: either chaotic, lawful or neutral
- Blessed creatures dealing additional damage to undeads. So it would make sense to bless even the creatures with magical attack.
- Usual humanoid speed is 6 cells per turn. Bat's speed is 14 cells/turn;. Leader moves at speed of 5.
- A unit that uses enemy's attack strength intstead of its own.
- A creature that can block, instead of moving or attacking. Blocking reduces any damage to 1.
- Elemental weakness. I.e. slimes being weak to fire
- Creature whose strength is proportional to owner's mana.

Spell Ideas:
- Equilibrium (law): target creature gets damage proportional to the total creatures its owner has, minus total creatures caster owns. Consider including tiers, so player won't be punished for using low-tier creatures. This spell is one way to break positive feedback.
- Simulacrum (law): creates illusionary copy of target creature to confuse the enemy. Simulacrum dies from a single hit.
- Reveal Spells/Items: shows on minimap places where items are located.
- Magic Block: target loses ability to cast spells for several turns.
- Slow (chaos): target unit moves at half of its speed.
- Torment (chaos): halves targets's health.
- Fire trail: make target unit leave fire trail behind him
- Water trail: make target unit leave water trail behind him; it also slows down the unit.
- Duel: create 3x3 arena in the center of map, where all 4 wizards get summoned.
- Chaos: shuffling (non-leader?) units inside of some range. Any implementation appears to be too random for my game design direction.
- Fire: alternative to firewall: a wave of fire would move across the land, burning grass and trees, but stoping at cliffs. Only the first row of trees should burn out, preventing single fire from shaving whole forest.
- Anchor: blocks target from teleporation.
- Exchange: swaps target and caster.
- Area of effect spell.
- Gooey Blob: slowly covers entire map in agressive blob, unless fought
- Drought: temporary removes all water, replacing it with special empty aux tile
- Harm Mirror: reflects damage from the next attack back to attacker.
- Return Harm: any damage target deals gets returned to it.
- Earthquake: damage all non-flyers.
- Wall: creates height=2 pilar of dirt
- Thunderstorm: damages all flyers.
- Toxic Gas: damages indoor units.
- Water Walk: allows unit to walk over water.
- Upkeep: enemy loses amount of mana proportional to the number of creatures under his control.
- Lock Abilities: target is unable to use its special abilities.
- Terraforming spells: raise/lower elevation, create/remove water pool, etc...
- Free Water: freezes water, allowing units to pass over it.
- Astral Attack: caster spends N mana to force target wizard lose N*2.
- Time Travel: caster first creates a snapshot, to which it can return from the future, but only single time. Make sure cooldown time of the spell won't be carried back with the caster.
- Time Travel 2: return target to the cell which it occupied at the start of its previous turn.
- Halt: target can't move, but can attack for the next turn.
- Bind/Chain: target's movement and cations get restricted to some area. Alternatively bind target to some object, so that target can only move towards that object.
- Berserk (chaos): increases target's attack, but decreases its health.
- Bloodlust (chaos): target unit gains +1 damage
- Protection (law): target unit gains +1 defense
- Disease: unit contaminates other units, getting near him, forcing owner to desperse the forces.
- Pacify: decreases target's attack, but increases its defense.
- Scrying/Tag: once cast on enemy creature, player can track it and see area around it.
- Visions: removes fog of war for one turn.
- Awareness: caster gets know when somebody casts a spell.
- Detect Curse: reveals for of war around cursed units.
- Enrage: when target can attack, limits its actions to attack. I.e. it can't retreat or move around the enemy.
- Mirror Image: creates a copy of target unit, that deals the same damage, but dies in a single hit.
- Spells that do both good/bad to you and your enemy.
- Regeneration: target starts regenerating even outside of power node.
- Vulnerability: decreases target's armor to 0
- Mist: engulfs cell in fog, so only units near it can see what is inside. No magic can target fog cells. Fog cells also slow movement.
- Slay: targets receives damage equal to half of its max health. Also consumes part of caster's health, proportional to target's health.
- Descend/Ascend: move unit between layers.
- Stalker: homing projectile, that wanders with time towards target enemy, hitting anyone standing on the way.
- Almagest: switches day to night and night to day
- Spy: wizard learns the next unknown spell, casted by any wizard.
- Clone Self: creates clone of self, which will continue leading, if creator dies
- Morph: turn caster into a monster, that is present on map and seen, until player cancels effect.
- Disguise: makes creature look like target creature, until it acts (simple movement doesn't break the illusion).
- Exorcise: a costy spell that can be used to banish any undead. Should cost two times more than a vampire.
- Open Node: tears the fabric of reality to open new magic node, which should be placed 4 cells away from an existing node
- Close Node: closes existing magic node
- Altar: non undead fallen creatures get resurrected as undeads here, as long as wizard stands near this structure.
- Vampirism: turns unit into a vampire.
- Palantir: wizard creates a scrying ball, keeping a creature near ball allows player to see through the fog of war. Yet it doesn't explore the map and doesn't reveal invisible creatures.
- Banish: target temporarily disappears and then returns to its caster's pentagram.
- Kill: kills target, that has less than half HP
- Spell that affect all units standing on a terrain of specific kind.
- Raise Dead: resurrect recently killed unit as undead.
- Guardian Angel: killed unit gets resurrected at pentagram.
- Passion: caster loses health, but gains mana.
- Live Shield: portion of damage to one creature gets redirected to another.
- Wind: nearby target gets displaced into one direction by N cells or until the closest height=2 block.
- Sacrifice: creature dies and its health is transfered to heal another.
- Amnesia: target leader forgets target spell.
- Aggravate: target neutral creature attacks enemies of the caster
- Employing telekinesis spell to use items as improvised weapon, like i.e. throwing rocks at enemies.
- Global enchantments like Zombie Mastery or See Everything could be represented by summoned/constructed map objects, that can easily be destroyed/disbanded, without introducing additional mechanics and complicating UI.


Leader Abilities:
- Pentagram (neutral): creates a portal, to which any controlled unit can be summoned. Enemy units remove it on entering.
- Fireball (chaos): throws a cheap fireball.
- Guardian (law): summons a turret, that can attack nearby enemies.
- Teleport (neutral): teleports caster to any seen location.

Status Effects:
- Cursed: unit is immune to non-magical weapons and poison, but suffers 100% more damage from blessed units.
- Blessed: unit can harm cursed units and break magic doors.
- Poison: unit can't regenerate and loses health with time, until health drops to 1 or heal is cast.
- Fire Aura: attacker gets damaged equivalent to their own damage, when melee attacking this unit.
- Hasted: unit gains additional moves per turn.
- Invisible: unit is invisible unit its next action non-movement.
- Shell: unit is invincible to the next physical attack.
- Resisting: unit is invincible to the next magical attack.
- Flying: unit can move over any terrain and gains addition sight.
- Afraid: unit can't attack.
- Organic: non-undead organic units can be target by attacks like life stealing.

Spells:
- Knowledge (neutral): converts mana into lore.
- Dispel (neutral): removes following enchantments: fear, haste, resist, shell, .
- Telekinesis (neutral): grabs key, treasure, mana, frees rescueable creatures, visits quest places, or operates an object from a distance. Can't be used at chests.
- Heal (law): target regains 9 health, and gets cured from poison and fear.
- Lightning (chaos): target loses 9 health. Target must be outdoor.
- Haste (law): target gains 2 additional movement points.
- Fear (chaos): target loses ability to act for the next three turns.
- Shell (law): target gains immunity to the next physical attack.
- Resist (chaos): target gains immunity to the next magical attack.
- Bless (law): target gains ability to harm undead and break magic doors.
- Curse (chaos): makes target immune to non-magical weapon, but vulnerable to blessed units.
- Invisibility (law): target becomes invisible, gaining 100% bonus to melee attack [make sure stats info show it]; attacking streaps invisibility.
- Firewall (chaos): creates a wall of fire at empty space, damaging creatures entering it. One wall burns for 10 turns, while cooldown is 5 turns, allowing wizard to support two walls at any given time.
- Flight (law): target gains ability to fly.
- Detonate (chaos): controlled creature explodes, dealing damage to all neighbors, equivalent to creature's health.
- Subvert (law): gain control over the target creature for one turn. Caster cannot perform any action, while controls the creature, except the "Relinquish Control" action.
- Armageddon (chaos): all units sustain 9 points of damage.
- The Spell of Mastery (neutral): banishes all competing wizards from this plane of existence. Requires learning all other spells to be cast.


Summonable Creatures:
Oculus: flyer, scout, clears invisibility from enemy units in sight.
Blob: slow, when in full health, can divide into two blobs of half health.
Imp: digs terrain, builds bridges, plants trees, places traps, constructs doors and supernatural doors (that only enchanted creatures can attack).
Ratman: becomes invisible, allowing him to move past enemies and steal treasures, or surprise attack.
Goblin: weakest shooter.
Elf: shooter.
Dwarf: defends, if dwarf haven't attacked this turn, all incoming damage is reduced to 1
Orc: has enough health to withstand a single lightning bolt.
Spider: poisons; can set web trap, entering which opponent loses all movement points and gets paralyzed for the next turn.
Lizard: fast, steed, immune to magic, climbs high terrain. Good for stalking wizards, who can't harm it.
Skeleton: undead.
Paladin: can heal himself or other unit.
Wraith: undead, flyer, becomes invisible.
Ifrit: flyer, fire shield damages attackers, throws fireballs, useful to counter undeads.
Griffin: flyer, steed, counter attacks on melee attack.
Minotaur: can stun-attack enemy for a single turn.
Devil: teleports to a seen cell, kills in a single blow any unit (even dragon), that has killed another. Vampire: undead, shooter, turns into bat, heals on attack. Creatures it kills raise from dead as undeads, with little health.
Observer: slow flyer, draws pentagrams, cast spells, like slow, fireball, teleport. Its attack strength is equal to its enemy.
Cyclops: heavy hitter
Hydra: moves over water, attacks in all four directions, regenerates everywhere.
Golem: slow, stoneskin: any incoming non-magic damage is reduced to 1.
Gargoyle: flyer, immune to magic, attacks with magic weapon.
Dragon: flyer, explodes on death (damaging all nearby creatures), can send nearby units flying into respective directions.

Unused Creatures:
Beetle:
Halfling:
Farmer:
Horse: fast, steed, can be captured on map

Digging Mechanics:
- only dirt is diggable.
- digging height>>3 dirt wall creates height=2 tunnel, but only if that cell is near height=3 wall. Obviously, one cannot dig under water.
- digging height=2 wall lowers it, but only if it isn't surrounded by height=3 walls.
- floor can be digged to create height=3 mine schaft with ladder, allowing unit do descend and ascend, if enemy unit blocks path, ascending/descending would attack it.
- digged out dirt could be restored.

Graphics:
- New player colors: player{blue},king{purple},warlock{black},witch{red},
                     katzard{green},mime{orange},neutral{white}
- dragon animation jumps horizontally during attack
- finish house tileset, including floor and roof; dirt/plain should not align to house wall
- better flight animation (idle-anim for floating effect and cloud under unit); use wesnoth halo/saurian-magic-halo-*; monster-elemental_air could be useful too
- better detonate effect, neighboring units sent flying into the air, knocked back in all directions.
- better hasted unit animation (trail after hasted creature)
- power node should have round bottom, so it would look more natural on rough terrain or in flight.
- Better stones tileset. Current one don't really fit in.
- Automate shadow placement
- road object, which would block grass
- grass corner sprites, which would be auto placed onto dirt in corners between two grass tiles.
- design fullscreen graphics effects, like armageddon, snowstorm, fog and nighttime.
- dummy units, that would be left instead of real one, when fog of war takes place
- fog of war reveal animation
- particle system
- New tilesets: Snow, Lava, Swamp
- beetle movement frame gets cropped;
- beetle needs attack animation;

UI:
- targeted units shouldn't blink
- add some description to tabs and menu tabs buttons
- unit profile and main menu options could be a tabs like all others
- monster sound acks
- ui/Tempest_In_The_Aether_Interface_and_Ryzom_Core has potentially usable icons
- a line from the portrait of current unit to its location on minimap
- better health indicators for selected units (use green dots - one per hit-point)
- in editor, placing unit on top of object should not be possible.
- simple way to temporarily transfer control to the AI, for map and AI testing.



Symta Language Handicaps:
- no way to quickly introduce an inplace field on a struct, like unit, propagating it to save-file.


Bugs:
- vampire on low health turning into bat results in bat being invincible with 0 health (enemies cant attack it)
- fix sound issues, where sounds are affected by height
- when new map gets saved, folder browser should update content
- when height>>80, column tiles and units are not drawn
- hydra damages and poisons allied units++
- invisibility doesnt hide poison, bood and regen effects
- flying units can possibly crash pathfinder, when they are at very high tiles, being able to cross border. Insert a check against mad dimensions.
- blizzard projectiles have no gravity
- player can research enemy units
- adding and removing table from corner crashes the game, due to attempt to place outside of the map
- multicell units, like table, react badly when drawing tiles under them. disallow drawing at all
- `update_picked` and unit.picked should use different picking strucutre. current is error prone and had led to bugs previously
- projectiles hung up, when their sender dies


Graphics Editing Hints:
- Grayscale layer can be used with "Darken" to change tile brightness.
- "Overlay" blending mode can be used to colorize grayscale image
- Removing transparency:
   1) Load Transparency Mask as Selection  (While pressing the Cmd key {Ctrl Key on PC} "click on" the image icon for this Layer in the Layers Panel
   2) Create Layer Mask from the Selection using Reveal Selection (Layer > Layer Mask > Reveal Selection)
   3) Display B&W Layer Mask  (While pressing the Option Key {Alt Key on PC} "click on" the layer mask icon for this Layer in the Layers Panel)
   4) Image > Adjustments > Threshold  with Threshold set to 255
- to split image into tiles: convert input.png -crop 64x64 +repage 3-idle%d.png
- to add missing digits: for i in *.png; do sename "\([^0-9]\)\([0-9]\)\.png" "0\0\1.png" $i; done

Optimization Possibilities:
- use cell index directly instead of unit_goal wrapper
- when all four corners of object sprite are hidden, don't allow selecting it, also, dont draw it. requires probing pixels inside framebuffer
- fast way to determine height to the ceiling - that way we can have large creature wont be able to move into tiny hole. One way to do it is by using special tiles in place of empty or void tiles
- obstacles blocking sight, would require precomputed sight tree, where one blocked node would block sight to all children.
- when updating tiles, we can also mark doorways, so that flyers and jumpers could pick between multiple Z-levels
- mouse picking can be done in reverse on draw list

Types of Creature Movement:
- Walker
- Flyer
- Swimmer (can walk over water)
- Climber (can scale walls)
- Incorporeal (Walk through doors and 1-tile walls) can be implemented using teleport spell



- Collectible spells, like weapons in Doom. That will greatly simplify gameplay and force wizard to explore world for new spells quickly, instead of turtling. It is also possible, that some spell be present in a single quantity, so only one wizard will ever obtain it. Spells could be presented at shrines, guarded by creatures. Only wizard can learn from such shrines. Maybe visiting shrine gives only a limited number of spellcasting. Optionally, there could be a way to steal enemy spells and a method that forces enemy to forget chosen spells.
  Pros:
    - lore gets eliminated;
    - exploration becomes fun;
    - easier to control what spells are available to player;
    - no annoying research dialogue;
    - map design get more involved, where player can get dragon since beginning;
  Cons:
    - start could be boring;
    - wizards lose specialization;
    - collectible spells could still be provided;
    - loss of strategic depth;
    - explorating can be encouraged through collecting map treasures, giving lore.
    - requires map designer to place all spells somewhere;
    - creating an icon system;
    - multiplayer maps would probably require to include some spells several times;
